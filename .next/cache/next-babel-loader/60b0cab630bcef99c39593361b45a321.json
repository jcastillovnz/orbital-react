{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/home/jcastillo-vnz/orbital-react/pages/components/View360/index.tsx\";\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport PreloadImages from './Preload'; // You can play with this to adjust the sensitivity\n// higher values make mouse less sensitive\n\nvar pixelsPerDegree = 2;\n\nvar App = function App(props) {\n  var dir = props.dir,\n      numImages = props.numImages;\n  console.log(\"dir: \", dir);\n  console.log(\"numImages: \", numImages);\n\n  var _useState = useState(Array),\n      images = _useState[0],\n      setImages = _useState[1];\n\n  var _useState2 = useState(0),\n      imageIndex = _useState2[0],\n      setImageIndex = _useState2[1];\n\n  var _useState3 = useState(false),\n      imagesPreloaded = _useState3[0],\n      setImagesPreloaded = _useState3[1];\n\n  var _useState4 = useState(false),\n      dragging = _useState4[0],\n      setDragging = _useState4[1];\n\n  var _useState5 = useState(0),\n      dragStartIndex = _useState5[0],\n      setDragStartIndex = _useState5[1];\n\n  var _useState6 = useState(0),\n      dragStart = _useState6[0],\n      setDragStart = _useState6[1];\n\n  var handleMouseMove = function handleMouseMove(e) {\n    if (dragging === false) {\n      updateImageIndex(e.screenX);\n      console.log(\"image index\", imageIndex);\n    }\n  };\n\n  var handleMouseDown = function handleMouseDown(e) {\n    e.persist();\n    setDragging(true);\n    setDragStart(e.screenX);\n    setDragStartIndex(imageIndex);\n  };\n\n  var handleMouseUp = function handleMouseUp() {\n    setDragging(false); // false\n  };\n\n  var updateImageIndex = function updateImageIndex(currentPosition) {\n    var pixelsPerImage = pixelsPerDegree * (360 / numImages);\n    var dx = (currentPosition - dragStart) / pixelsPerImage;\n    var index = Math.floor(dx) % numImages;\n\n    if (index < 0) {\n      index = numImages + index - 1;\n    }\n\n    index = (index + dragStartIndex) % numImages;\n\n    if (index !== imageIndex) {\n      setImageIndex(index);\n    }\n  };\n\n  var preventDragHandler = function preventDragHandler(e) {\n    e.preventDefault();\n  };\n\n  var handlePreloadImages = function handlePreloadImages() {\n    var i, _imageIndex, filePath;\n\n    return _regeneratorRuntime.async(function handlePreloadImages$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            for (i = 0; i <= numImages - 1; i++) {\n              _imageIndex = i;\n              filePath = \"\".concat(dir, \"/\").concat(_imageIndex, \".jpg\");\n              images.push(filePath);\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(PreloadImages(images).then(function () {\n              setImagesPreloaded(true);\n            }));\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    handlePreloadImages();\n    document.addEventListener(\"mousemove\", handleMouseMove, false);\n    document.addEventListener(\"mouseup\", handleMouseUp, false); // returned function will be called on component unmount \n\n    return function () {\n      console.log(\"se desmonta\");\n      document.removeEventListener('mousemove', handleMouseMove, false);\n      document.removeEventListener(\"mouseup\", handleMouseUp, false);\n    };\n  }, []);\n\n  var renderImage = function renderImage() {\n    return __jsx(\"div\", {\n      style: {\n        position: 'absolute',\n        width: 'auto',\n        display: 'block',\n        margin: '0 auto',\n        'text-align': 'left'\n      },\n      className: \"react360\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }, __jsx(\"img\", {\n      style: {\n        margin: 'auto',\n        position: 'relative',\n        height: '95vh',\n        width: 'auto',\n        display: 'flex',\n        'justify-content': 'center',\n        'align-items': 'center',\n        'background-color': 'white',\n        '-webkit-user-select': 'none',\n        '-khtml-user-select': 'none',\n        '-moz-user-select': 'none',\n        '-ms-user-select': 'none',\n        '-o-user-select': 'none',\n        'user-select': 'none',\n        left: '82%',\n        bottom: '150%',\n        top: '-25%',\n        'transform': 'translate(-50%, 0)',\n        '-ms-transform': 'translate(-50%, 0)',\n        '-webkit-transform': 'translate(-50%, 0)',\n        'z-index': 0\n      },\n      className: \"react-360-img\",\n      src: \"\".concat(dir, \"/\").concat(imageIndex, \".jpg\")\n      /*  src={require(`${dir}/${imageIndex}.jpg`)} */\n      ,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  return __jsx(\"div\", {\n    className: \"react-360-img\",\n    onMouseDown: handleMouseDown,\n    onDragStart: preventDragHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    style: {\n      position: 'fixed'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, \"Metrics:\", __jsx(\"ul\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }, \"Num images: \", numImages), __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }, \"Image index: \", imageIndex), __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }, \"Dragging:\", dragging ? 'Is dragging' : 'No draggin'), __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 11\n    }\n  }, \"DragStart:\", dragStart), __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 11\n    }\n  }, \"imagesPreloaded:\", imagesPreloaded), __jsx(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, \"DragStartIndex: \", dragStartIndex))), renderImage());\n};\n\nexport default App;","map":{"version":3,"sources":["/home/jcastillo-vnz/orbital-react/pages/components/View360/index.tsx"],"names":["React","useState","useEffect","PreloadImages","pixelsPerDegree","App","props","dir","numImages","console","log","Array","images","setImages","imageIndex","setImageIndex","imagesPreloaded","setImagesPreloaded","dragging","setDragging","dragStartIndex","setDragStartIndex","dragStart","setDragStart","handleMouseMove","e","updateImageIndex","screenX","handleMouseDown","persist","handleMouseUp","currentPosition","pixelsPerImage","dx","index","Math","floor","preventDragHandler","preventDefault","handlePreloadImages","i","filePath","push","then","document","addEventListener","removeEventListener","renderImage","position","width","display","margin","height","left","bottom","top"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PreloadImages from './Preload'\n\n// You can play with this to adjust the sensitivity\n// higher values make mouse less sensitive\nconst pixelsPerDegree = 2;\ninterface props {\n  dir: string\n  numImages?: number\n}\n\n\nconst App = (props: props) => {\n  const { dir, numImages } = props;\n  console.log(\"dir: \", dir)\n  console.log(\"numImages: \", numImages)\n\n  const [images, setImages] = useState(Array);\n  const [imageIndex, setImageIndex] = useState(0);\n  const [imagesPreloaded, setImagesPreloaded] = useState(false);\n  const [dragging, setDragging] = useState(false);\n  const [dragStartIndex, setDragStartIndex] = useState(0);\n  const [dragStart, setDragStart] = useState(0);\n\n  const handleMouseMove = (e) => {\n    if (dragging === false) {\n      updateImageIndex(e.screenX);\n      console.log(\"image index\", imageIndex)\n    }\n  };\n\n  const handleMouseDown = (e) => {\n    e.persist();\n    setDragging(true)\n    setDragStart(e.screenX)\n    setDragStartIndex(imageIndex)\n  };\n\n  const handleMouseUp = () => {\n    setDragging(false)  // false\n  };\n\n  const updateImageIndex = (currentPosition) => {\n    const pixelsPerImage = pixelsPerDegree * (360 / numImages);\n    let dx = (currentPosition - dragStart) / pixelsPerImage;\n    let index = Math.floor(dx) % numImages;\n\n    if (index < 0) {\n      index = numImages + index - 1;\n    }\n    index = (index + dragStartIndex) % numImages;\n    if (index !== imageIndex) {\n      setImageIndex(index)\n    }\n  };\n\n  const preventDragHandler = e => {\n    e.preventDefault();\n  };\n\n  const handlePreloadImages = async () => {\n    for(let i=0; i <= numImages -1; i++){\n      const imageIndex = i\n      const filePath = `${dir}/${imageIndex}.jpg`\n      images.push(filePath)\n  }\n  await  PreloadImages(images).then(() => {\n      setImagesPreloaded(true)\n    });\n  }\n\n  useEffect(() => {\n    handlePreloadImages();\n    document.addEventListener(\"mousemove\", handleMouseMove, false);\n    document.addEventListener(\"mouseup\", handleMouseUp, false);\n    // returned function will be called on component unmount \n    return () => {\n      console.log(\"se desmonta\")\n      document.removeEventListener('mousemove', handleMouseMove, false);\n      document.removeEventListener(\"mouseup\", handleMouseUp, false);\n    }\n  }, []);\n\n\n\n\n  const renderImage = () => {\n\n    return (\n      <div style={{\n        position: 'absolute',\n        width: 'auto',\n        display: 'block',\n        margin: '0 auto',\n        'text-align': 'left',\n      } as React.CSSProperties} className=\"react360\">\n        <img style={{\n          margin: 'auto',\n          position: 'relative',\n          height: '95vh',\n          width: 'auto',\n          display: 'flex',\n          'justify-content': 'center',\n          'align-items': 'center',\n          'background-color': 'white',\n          '-webkit-user-select': 'none',\n          '-khtml-user-select': 'none',\n          '-moz-user-select': 'none',\n          '-ms-user-select': 'none',\n          '-o-user-select': 'none',\n          'user-select': 'none',\n          left: '82%',\n          bottom: '150%',\n          top: '-25%',\n          'transform': 'translate(-50%, 0)',\n          '-ms-transform': 'translate(-50%, 0)',\n          '-webkit-transform': 'translate(-50%, 0)',\n          'z-index': 0\n        } as React.CSSProperties}\n          className=\"react-360-img\"\n          src={`${dir}/${imageIndex}.jpg`}\n        /*  src={require(`${dir}/${imageIndex}.jpg`)} */\n        />\n\n      </div>\n    );\n  };\n\n\n  return (\n    <div\n      className=\"react-360-img\"\n      onMouseDown={handleMouseDown}\n      onDragStart={preventDragHandler}\n\n    >\n      <div style={{ position: 'fixed' }}>\n        Metrics:\n        <ul>\n          <li>\n            Num images: {numImages}\n          </li>\n          <li>\n            Image index: {imageIndex}\n          </li>\n          <li>\n            Dragging:{dragging ? 'Is dragging' : 'No draggin'}\n          </li>\n          <li>\n            DragStart:{dragStart}\n          </li>\n          <li>\n            imagesPreloaded:{imagesPreloaded}\n          </li>\n          <li>\n            DragStartIndex: {dragStartIndex}\n          </li>\n        </ul>\n      </div>\n      {renderImage()}\n    </div>\n  );\n\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}